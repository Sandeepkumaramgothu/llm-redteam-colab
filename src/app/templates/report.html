<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Run Report</title>
    <style>
      body { font-family: system-ui, Arial, sans-serif; margin: 2rem; }
      h2 { margin-bottom: 0.25rem; }
      .muted { color: #666; font-size: 0.95rem; }
      .mono { font-family: ui-monospace, Menlo, Consolas, monospace; white-space: pre-wrap; }
      table { border-collapse: collapse; width: 100%; margin-top: 1rem; }
      th, td { border: 1px solid #ddd; padding: 8px; vertical-align: top; }
      th { background: #f6f6f6; }
      .pill { display: inline-block; padding: 2px 8px; border-radius: 999px; background: #eef; }
      a { color: #1a73e8; text-decoration: none; }
      a:hover { text-decoration: underline; }
    </style>
  </head>
  <body>
    {% if not found %}
      <h2>No runs yet</h2>
      <p class="muted">Please go back to the home page and click Start first.</p>
      <p><a href="/">← Home</a></p>
    {% else %}
      <h2>Run Report</h2>
      <div class="muted">Run folder: <span class="mono">{{ run_id }}</span></div>

      <h3>Summary</h3>
      <ul>
        <li><b>Count</b>: {{ metrics.count }}</li>
        <li><b>ASR</b>: {{ metrics.asr }}</li>
      </ul>

      <h3>Artifacts</h3>
      <ul>
        <li><a href="/{{ run_id }}/config_resolved.json" target="_blank">config_resolved.json</a></li>
        <li><a href="/{{ run_id }}/metrics.json" target="_blank">metrics.json</a></li>
        <li><a href="/{{ run_id }}/interactions.jsonl" target="_blank">interactions.jsonl</a></li>
        <li><a href="/{{ run_id }}/status.json" target="_blank">status.json</a></li>
      </ul>

      <h3>First few samples</h3>
      <table>
        <tr>
          <th>#</th>
          <th>Prompt</th>
          <th>Model Output</th>
          <th>Reward (score, level)</th>
        </tr>
        {% for s in samples %}
        <tr>
          <td>{{ loop.index }}</td>
          <td class="mono">{{ s.prompt }}</td>
          <td class="mono">{{ s.output[:500] }}{% if s.output|length > 500 %}…{% endif %}</td>
          <td>
            <div class="pill">score: {{ s.reward.score }}</div>
            <div class="pill">level: {{ s.reward.level }}</div>
          </td>
        </tr>
        {% endfor %}
      </table>

      <p><a href="/">← Back to Home</a></p>
    {% endif %}
  </body>
</html>
